---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import ServiceCard from '../components/ServiceCard.astro';
import CtaSection from '../components/CtaSection.astro';
import TextSection from '../components/TextSection.astro';

// Import page content from Tina
import pageContent from '../../content/pages/servizi.json';

// Import all services
import consulenza from '../../content/services/consulenza-strategica.json';
import sviluppo from '../../content/services/sviluppo-web.json';
import marketing from '../../content/services/marketing-digitale.json';

const allServices = [consulenza, sviluppo, marketing].sort((a, b) => (a.order || 0) - (b.order || 0));

const { hero, sections, seo } = pageContent;
---

<Layout title={seo?.metaTitle || pageContent.title} description={seo?.metaDescription}>
  <!-- Hero Section -->
  {hero && (
    <Hero
      headline={hero.headline || ''}
      subheadline={hero.subheadline}
      backgroundImage={hero.backgroundImage}
      compact={true}
    />
  )}

  <!-- Text intro if present -->
  {sections?.filter((s: any) => s._template === 'textSection').map((section: any) => (
    <TextSection
      title={section.title}
      content={section.content}
    />
  ))}

  <!-- Services Grid -->
  <section class="section bg-gray-50">
    <div class="container-custom">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {allServices.map((service) => (
          <ServiceCard
            title={service.title}
            description={service.shortDescription || ''}
            icon={service.icon}
            image={service.image}
            features={service.features}
          />
        ))}
      </div>
    </div>
  </section>

  <!-- CTA Section if present -->
  {sections?.filter((s: any) => s._template === 'ctaSection').map((section: any) => (
    <CtaSection
      title={section.title || ''}
      subtitle={section.subtitle}
      buttonText={section.buttonText || 'Contattaci'}
      buttonLink={section.buttonLink || '/contatti'}
    />
  ))}
</Layout>
